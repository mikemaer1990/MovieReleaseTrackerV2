<div class="follow-action-partial">
  <% if (user) { %>
    <div class="follow-container"
         data-movie-id="<%= movie.id %>"
         data-title="<%= movie.title %>"
         data-release-date="<%= movie.release_date %>"
         data-streaming-date="<%= movie.streamingDateRaw || '' %>"
         data-poster-path="<%= movie.poster_path %>">

      <% if (followedMovieIds && followedMovieIds.includes(Number(movie.id))) { %>
        <!-- Unfollow Button (JS will handle the click) -->
        <button type="button" class="unfollow-button" title="Click to unfollow this movie">
          Unfollow
        </button>
      <% } else { %>
        <!-- Follow Button (JS will handle the click) -->
        <button type="button" 
          class="follow-button" 
          <%= movie.canFollow ? 'title="Click to follow this movie"' : 'disabled title="Released"' %>>
          Follow
        </button>
      <% } %>

      <!-- Follow Options Panel (hidden by default, can be shown via JS) -->
      <div class="follow-options-panel" aria-hidden="true">
        <button class="follow-type-btn" data-type="theatrical" title="Theatrical Release (cinema only)" aria-label="Follow theatrical release">🎭</button>
        <button class="follow-type-btn" data-type="streaming" title="Streaming Release (digital/streaming)" aria-label="Follow streaming release">📺</button>
        <button class="follow-type-btn" data-type="both" title="Both Releases (theatrical + streaming)" aria-label="Follow both releases">🎬</button>
      </div>
    </div>
  <% } else { %>
    <!-- Login to follow -->
    <a class="login-to-follow" 
       href="/auth/login?redirect=<%= encodeURIComponent(loginRedirect) %>">
      Login
    </a>
  <% } %>
</div>